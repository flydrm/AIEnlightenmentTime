# AIå¯è’™æ—¶å…‰ - äº‘ç«¯ä¼˜åŒ–UIè®¾è®¡æ–¹æ¡ˆ v3.0

## 1. è®¾è®¡ç†å¿µ

### 1.1 æ ¸å¿ƒåŸåˆ™
- **å³æ—¶åé¦ˆ**: æ¯ä¸ªæ“ä½œéƒ½æœ‰å³æ—¶è§†è§‰åé¦ˆ
- **åŠ è½½ä¼˜åŒ–**: æ¸è¿›å¼åŠ è½½ï¼Œå‡å°‘ç­‰å¾…æ„Ÿ
- **é”™è¯¯å‹å¥½**: ç½‘ç»œé—®é¢˜æ—¶æä¾›å‹å¥½å¼•å¯¼
- **ç®€æ´é«˜æ•ˆ**: å‡å°‘æ“ä½œæ­¥éª¤ï¼Œå¿«é€Ÿè¾¾åˆ°ç›®æ ‡

### 1.2 è®¾è®¡ç›®æ ‡
- è®©ç­‰å¾…æ—¶é—´å˜å¾—æœ‰è¶£
- ç½‘ç»œé—®é¢˜æ—¶ä¸è®©å­©å­æ²®ä¸§
- å……åˆ†åˆ©ç”¨ç¼“å­˜å†…å®¹
- ä¿æŒäº¤äº’çš„æµç•…æ€§

---

## 2. ä¸»ç•Œé¢è®¾è®¡

### 2.1 é¦–é¡µå¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          AIå¯è’™æ—¶å…‰                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚ ğŸ¼      â”‚                   â”‚
â”‚         â”‚  å°ç†ŠçŒ«   â”‚                   â”‚
â”‚         â”‚ (åŠ¨æ€è¡¨æƒ…) â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚      ä»Šæ—¥æ¨è               â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”      â”‚    â”‚
â”‚   â”‚  â”‚æ•…äº‹â”‚ â”‚æ¸¸æˆâ”‚ â”‚åˆ›ä½œâ”‚      â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚      å¿«é€Ÿå¼€å§‹               â”‚    â”‚
â”‚   â”‚  â— ç»§ç»­æ˜¨å¤©çš„æ•…äº‹           â”‚    â”‚
â”‚   â”‚  â— å’Œå°ç†ŠçŒ«èŠå¤©            â”‚    â”‚
â”‚   â”‚  â— ç”»ç”»åˆ›ä½œ               â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                        â”‚
â”‚   [ç½‘ç»œ: âœ“] [ç¼“å­˜: 5ä¸ªæ•…äº‹]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 åŠ è½½çŠ¶æ€è®¾è®¡
```kotlin
// åŠ è½½çŠ¶æ€UIç»„ä»¶
@Composable
fun LoadingStateUI(
    loadingType: LoadingType,
    progress: Float? = null
) {
    when (loadingType) {
        LoadingType.STORY_GENERATING -> {
            StoryGeneratingAnimation(
                messages = listOf(
                    "å°ç†ŠçŒ«æ­£åœ¨æ„æ€ç²¾å½©æ•…äº‹...",
                    "æ·»åŠ æœ‰è¶£çš„æƒ…èŠ‚...",
                    "é©¬ä¸Šå°±å¥½..."
                ),
                progress = progress
            )
        }
        
        LoadingType.IMAGE_GENERATING -> {
            ImageGeneratingAnimation(
                stages = listOf(
                    "æ­£åœ¨ç”»è‰ç¨¿..." to 0.3f,
                    "ä¸Šè‰²ä¸­..." to 0.6f,
                    "æ·»åŠ ç»†èŠ‚..." to 0.9f,
                    "å®Œæˆï¼" to 1.0f
                )
            )
        }
        
        LoadingType.THINKING -> {
            PandaThinkingAnimation(
                bubbles = listOf("ğŸ¤”", "ğŸ’­", "ğŸ’¡")
            )
        }
    }
}

// æ¸è¿›å¼å†…å®¹åŠ è½½
@Composable
fun ProgressiveContent(
    content: ContentState
) {
    when (content) {
        is ContentState.Loading -> {
            // æ˜¾ç¤ºéª¨æ¶å±
            ContentSkeleton()
        }
        
        is ContentState.Partial -> {
            // æ˜¾ç¤ºå·²åŠ è½½éƒ¨åˆ†
            Column {
                Text(content.loadedText)
                if (content.isLoadingMore) {
                    LoadingIndicator()
                }
            }
        }
        
        is ContentState.Complete -> {
            // å®Œæ•´å†…å®¹
            CompleteContent(content.data)
        }
    }
}
```

---

## 3. æ ¸å¿ƒåŠŸèƒ½UIä¼˜åŒ–

### 3.1 AIå¯¹è¯ç•Œé¢
```kotlin
@Composable
fun OptimizedChatUI(
    chatState: ChatState,
    onSendMessage: (String) -> Unit
) {
    Column(modifier = Modifier.fillMaxSize()) {
        // å¯¹è¯å†å²
        LazyColumn(
            modifier = Modifier.weight(1f),
            reverseLayout = true
        ) {
            items(chatState.messages) { message ->
                when (message) {
                    is Message.User -> UserMessage(message)
                    is Message.AI -> AIMessage(message)
                    is Message.Loading -> LoadingMessage()
                    is Message.Error -> ErrorMessage(
                        error = message.error,
                        onRetry = message.onRetry
                    )
                }
            }
        }
        
        // è¾“å…¥åŒºåŸŸ
        ChatInputBar(
            enabled = chatState.canSend,
            onSend = onSendMessage,
            suggestions = chatState.quickReplies
        )
        
        // ç½‘ç»œçŠ¶æ€æç¤º
        if (!chatState.isOnline) {
            OfflineHint(
                text = "å½“å‰ç¦»çº¿ï¼Œä»…é™åŸºç¡€å¯¹è¯"
            )
        }
    }
}

// AIæ¶ˆæ¯ç»„ä»¶
@Composable
fun AIMessage(message: Message.AI) {
    Row(
        modifier = Modifier.padding(8.dp)
    ) {
        // å°ç†ŠçŒ«å¤´åƒ
        PandaAvatar(
            emotion = message.emotion,
            size = 40.dp
        )
        
        Spacer(modifier = Modifier.width(8.dp))
        
        // æ¶ˆæ¯å†…å®¹
        Card(
            colors = CardDefaults.cardColors(
                containerColor = MaterialTheme.colorScheme.primaryContainer
            )
        ) {
            Column(modifier = Modifier.padding(12.dp)) {
                // æ‰“å­—æœºæ•ˆæœ
                AnimatedText(
                    text = message.text,
                    animationDuration = message.text.length * 20L
                )
                
                // ç›¸å…³æ“ä½œ
                if (message.actions.isNotEmpty()) {
                    Row(
                        modifier = Modifier.padding(top = 8.dp),
                        horizontalArrangement = Arrangement.spacedBy(8.dp)
                    ) {
                        message.actions.forEach { action ->
                            OutlinedButton(
                                onClick = action.onClick,
                                modifier = Modifier.height(32.dp)
                            ) {
                                Text(action.label, fontSize = 12.sp)
                            }
                        }
                    }
                }
            }
        }
    }
}
```

### 3.2 æ•…äº‹ç”Ÿæˆç•Œé¢
```kotlin
@Composable
fun StoryGenerationUI(
    state: StoryGenerationState,
    onGenerateStory: (StoryParams) -> Unit
) {
    when (state) {
        is StoryGenerationState.Setup -> {
            // æ•…äº‹è®¾ç½®ç•Œé¢
            StorySetupScreen(
                onConfirm = onGenerateStory,
                cachedThemes = state.cachedThemes
            )
        }
        
        is StoryGenerationState.Generating -> {
            // ç”Ÿæˆä¸­åŠ¨ç”»
            GeneratingStoryAnimation(
                progress = state.progress,
                currentStage = state.stage
            )
        }
        
        is StoryGenerationState.Ready -> {
            // æ•…äº‹å±•ç¤º
            StoryDisplay(
                story = state.story,
                illustration = state.illustration
            )
        }
        
        is StoryGenerationState.Error -> {
            // é”™è¯¯å¤„ç†
            StoryErrorScreen(
                error = state.error,
                cachedStories = state.availableOfflineStories,
                onRetry = state.onRetry,
                onSelectCached = state.onSelectCached
            )
        }
    }
}

// ç”ŸæˆåŠ¨ç”»ç»„ä»¶
@Composable
fun GeneratingStoryAnimation(
    progress: Float,
    currentStage: String
) {
    Box(
        modifier = Modifier.fillMaxSize(),
        contentAlignment = Alignment.Center
    ) {
        Column(
            horizontalAlignment = Alignment.CenterHorizontally
        ) {
            // å°ç†ŠçŒ«å†™ä½œåŠ¨ç”»
            LottieAnimation(
                composition = rememberLottieComposition(
                    LottieCompositionSpec.RawRes(R.raw.panda_writing)
                ),
                progress = { progress },
                modifier = Modifier.size(200.dp)
            )
            
            Spacer(modifier = Modifier.height(24.dp))
            
            // è¿›åº¦æ¡
            LinearProgressIndicator(
                progress = progress,
                modifier = Modifier
                    .width(250.dp)
                    .height(8.dp)
                    .clip(RoundedCornerShape(4.dp))
            )
            
            Spacer(modifier = Modifier.height(16.dp))
            
            // å½“å‰é˜¶æ®µæç¤º
            Text(
                text = currentStage,
                style = MaterialTheme.typography.bodyLarge,
                color = MaterialTheme.colorScheme.onSurfaceVariant
            )
            
            // å–æ¶ˆæŒ‰é’®
            TextButton(
                onClick = { /* å–æ¶ˆç”Ÿæˆ */ },
                modifier = Modifier.padding(top = 16.dp)
            ) {
                Text("å–æ¶ˆ")
            }
        }
    }
}
```

### 3.3 å›¾åƒç”Ÿæˆç•Œé¢
```kotlin
@Composable
fun ImageGenerationUI(
    state: ImageGenerationState
) {
    Column(
        modifier = Modifier.fillMaxSize()
    ) {
        // è¾“å…¥åŒºåŸŸ
        Card(
            modifier = Modifier
                .fillMaxWidth()
                .padding(16.dp)
        ) {
            Column(modifier = Modifier.padding(16.dp)) {
                Text(
                    text = "å‘Šè¯‰å°ç†ŠçŒ«ä½ æƒ³ç”»ä»€ä¹ˆ",
                    style = MaterialTheme.typography.headlineSmall
                )
                
                Spacer(modifier = Modifier.height(8.dp))
                
                OutlinedTextField(
                    value = state.prompt,
                    onValueChange = state.onPromptChange,
                    placeholder = { Text("ä¾‹å¦‚ï¼šä¸€åªåœ¨æœˆçƒä¸Šçš„å°å…”å­") },
                    modifier = Modifier.fillMaxWidth()
                )
                
                // å¿«é€Ÿé€‰æ‹©æ ‡ç­¾
                FlowRow(
                    modifier = Modifier.padding(top = 8.dp),
                    horizontalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    state.suggestions.forEach { suggestion ->
                        SuggestionChip(
                            onClick = { state.onPromptChange(suggestion) },
                            label = { Text(suggestion) }
                        )
                    }
                }
                
                Button(
                    onClick = state.onGenerate,
                    enabled = state.canGenerate,
                    modifier = Modifier
                        .align(Alignment.End)
                        .padding(top = 8.dp)
                ) {
                    Text("å¼€å§‹åˆ›ä½œ")
                }
            }
        }
        
        // ç»“æœæ˜¾ç¤ºåŒºåŸŸ
        Box(
            modifier = Modifier
                .fillMaxSize()
                .padding(16.dp)
        ) {
            when (state.result) {
                is ImageResult.Generating -> {
                    ImageGeneratingProgress(
                        progress = state.result.progress,
                        preview = state.result.preview
                    )
                }
                
                is ImageResult.Success -> {
                    GeneratedImageDisplay(
                        imageUrl = state.result.imageUrl,
                        onSave = state.onSave,
                        onRegenerate = state.onRegenerate
                    )
                }
                
                is ImageResult.Error -> {
                    ImageErrorDisplay(
                        error = state.result.error,
                        onRetry = state.onRetry
                    )
                }
                
                null -> {
                    // ç©ºçŠ¶æ€æç¤º
                    EmptyStateHint()
                }
            }
        }
    }
}
```

---

## 4. ç¦»çº¿ä¼˜åŒ–UI

### 4.1 ç¦»çº¿æ¨¡å¼æŒ‡ç¤º
```kotlin
@Composable
fun NetworkStatusIndicator(
    isOnline: Boolean,
    cachedContentCount: Int
) {
    AnimatedVisibility(
        visible = !isOnline,
        enter = slideInVertically() + fadeIn(),
        exit = slideOutVertically() + fadeOut()
    ) {
        Card(
            modifier = Modifier
                .fillMaxWidth()
                .padding(horizontal = 16.dp),
            colors = CardDefaults.cardColors(
                containerColor = MaterialTheme.colorScheme.surfaceVariant
            )
        ) {
            Row(
                modifier = Modifier.padding(12.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                Icon(
                    imageVector = Icons.Default.CloudOff,
                    contentDescription = null,
                    tint = MaterialTheme.colorScheme.onSurfaceVariant
                )
                
                Spacer(modifier = Modifier.width(8.dp))
                
                Column(modifier = Modifier.weight(1f)) {
                    Text(
                        text = "ç¦»çº¿æ¨¡å¼",
                        style = MaterialTheme.typography.titleSmall
                    )
                    Text(
                        text = "æœ‰${cachedContentCount}ä¸ªç¦»çº¿å†…å®¹å¯ç”¨",
                        style = MaterialTheme.typography.bodySmall
                    )
                }
                
                TextButton(onClick = { /* æŸ¥çœ‹ç¦»çº¿å†…å®¹ */ }) {
                    Text("æŸ¥çœ‹")
                }
            }
        }
    }
}
```

### 4.2 ç¼“å­˜å†…å®¹å±•ç¤º
```kotlin
@Composable
fun CachedContentGrid(
    cachedItems: List<CachedContent>,
    onItemClick: (CachedContent) -> Unit
) {
    LazyVerticalGrid(
        columns = GridCells.Adaptive(minSize = 160.dp),
        contentPadding = PaddingValues(16.dp),
        horizontalArrangement = Arrangement.spacedBy(12.dp),
        verticalArrangement = Arrangement.spacedBy(12.dp)
    ) {
        items(cachedItems) { item ->
            CachedContentCard(
                content = item,
                onClick = { onItemClick(item) }
            )
        }
    }
}

@Composable
fun CachedContentCard(
    content: CachedContent,
    onClick: () -> Unit
) {
    Card(
        onClick = onClick,
        modifier = Modifier.fillMaxWidth()
    ) {
        Column(
            modifier = Modifier.padding(12.dp)
        ) {
            // å†…å®¹å›¾æ ‡
            Box(
                modifier = Modifier
                    .fillMaxWidth()
                    .height(100.dp)
                    .background(
                        color = MaterialTheme.colorScheme.primaryContainer,
                        shape = RoundedCornerShape(8.dp)
                    ),
                contentAlignment = Alignment.Center
            ) {
                Icon(
                    imageVector = content.type.icon,
                    contentDescription = null,
                    modifier = Modifier.size(48.dp),
                    tint = MaterialTheme.colorScheme.onPrimaryContainer
                )
                
                // ç¦»çº¿æ ‡è®°
                Badge(
                    modifier = Modifier.align(Alignment.TopEnd)
                ) {
                    Icon(
                        imageVector = Icons.Default.DownloadDone,
                        contentDescription = "å·²ä¸‹è½½",
                        modifier = Modifier.size(12.dp)
                    )
                }
            }
            
            Spacer(modifier = Modifier.height(8.dp))
            
            Text(
                text = content.title,
                style = MaterialTheme.typography.titleSmall,
                maxLines = 2,
                overflow = TextOverflow.Ellipsis
            )
            
            Text(
                text = content.description,
                style = MaterialTheme.typography.bodySmall,
                color = MaterialTheme.colorScheme.onSurfaceVariant,
                maxLines = 1,
                overflow = TextOverflow.Ellipsis
            )
        }
    }
}
```

---

## 5. é”™è¯¯å¤„ç†UI

### 5.1 å‹å¥½çš„é”™è¯¯é¡µé¢
```kotlin
@Composable
fun FriendlyErrorScreen(
    error: AppError,
    onAction: (ErrorAction) -> Unit
) {
    Box(
        modifier = Modifier
            .fillMaxSize()
            .padding(24.dp),
        contentAlignment = Alignment.Center
    ) {
        Column(
            horizontalAlignment = Alignment.CenterHorizontally,
            verticalArrangement = Arrangement.spacedBy(16.dp)
        ) {
            // é”™è¯¯æ’ç”»
            ErrorIllustration(
                errorType = error.type,
                modifier = Modifier.size(200.dp)
            )
            
            // é”™è¯¯æ ‡é¢˜
            Text(
                text = error.friendlyTitle,
                style = MaterialTheme.typography.headlineMedium,
                textAlign = TextAlign.Center
            )
            
            // é”™è¯¯æè¿°
            Text(
                text = error.friendlyMessage,
                style = MaterialTheme.typography.bodyLarge,
                textAlign = TextAlign.Center,
                color = MaterialTheme.colorScheme.onSurfaceVariant
            )
            
            // æ“ä½œæŒ‰é’®
            Row(
                horizontalArrangement = Arrangement.spacedBy(12.dp)
            ) {
                if (error.canRetry) {
                    Button(
                        onClick = { onAction(ErrorAction.Retry) }
                    ) {
                        Icon(Icons.Default.Refresh, null)
                        Spacer(modifier = Modifier.width(8.dp))
                        Text("é‡è¯•")
                    }
                }
                
                if (error.hasOfflineOption) {
                    OutlinedButton(
                        onClick = { onAction(ErrorAction.UseOffline) }
                    ) {
                        Icon(Icons.Default.CloudOff, null)
                        Spacer(modifier = Modifier.width(8.dp))
                        Text("ç¦»çº¿å†…å®¹")
                    }
                }
            }
        }
    }
}

// é”™è¯¯ç±»å‹å¯¹åº”çš„å‹å¥½æ–‡æ¡ˆ
fun AppError.toFriendlyError(): FriendlyError = when (this) {
    is NetworkError -> FriendlyError(
        type = ErrorType.NETWORK,
        friendlyTitle = "ç½‘ç»œå¼€å°å·®äº†",
        friendlyMessage = "å°ç†ŠçŒ«æš‚æ—¶è”ç³»ä¸ä¸Šäº‘æœµï¼Œæ£€æŸ¥ä¸€ä¸‹ç½‘ç»œå§",
        canRetry = true,
        hasOfflineOption = true
    )
    
    is TimeoutError -> FriendlyError(
        type = ErrorType.TIMEOUT,
        friendlyTitle = "æ€è€ƒæ—¶é—´æœ‰ç‚¹é•¿",
        friendlyMessage = "å°ç†ŠçŒ«åœ¨åŠªåŠ›æ€è€ƒï¼Œè¦ä¸è¦å†ç­‰ç­‰ï¼Ÿ",
        canRetry = true,
        hasOfflineOption = true
    )
    
    is ServerError -> FriendlyError(
        type = ErrorType.SERVER,
        friendlyTitle = "æœåŠ¡å™¨ä¼‘æ¯ä¸­",
        friendlyMessage = "äº‘æœµä¸Šçš„æœ‹å‹ä»¬åœ¨ä¼‘æ¯ï¼Œä¸€ä¼šå„¿å†æ¥æ‰¾ä»–ä»¬å§",
        canRetry = true,
        hasOfflineOption = true
    )
    
    else -> FriendlyError(
        type = ErrorType.UNKNOWN,
        friendlyTitle = "å‡ºäº†ç‚¹å°çŠ¶å†µ",
        friendlyMessage = "åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šä¿®å¥½çš„",
        canRetry = true,
        hasOfflineOption = false
    )
}
```

### 5.2 åŠ è½½è¶…æ—¶å¤„ç†
```kotlin
@Composable
fun TimeoutDialog(
    onWait: () -> Unit,
    onCancel: () -> Unit,
    onUseCache: () -> Unit
) {
    AlertDialog(
        onDismissRequest = onCancel,
        icon = {
            Icon(
                imageVector = Icons.Default.HourglassEmpty,
                contentDescription = null,
                modifier = Modifier.size(48.dp)
            )
        },
        title = {
            Text("éœ€è¦å¤šä¸€ç‚¹æ—¶é—´")
        },
        text = {
            Text("ç”Ÿæˆå†…å®¹éœ€è¦æ›´å¤šæ—¶é—´ï¼Œæ‚¨å¯ä»¥ï¼š")
        },
        confirmButton = {
            TextButton(onClick = onWait) {
                Text("ç»§ç»­ç­‰å¾…")
            }
        },
        dismissButton = {
            Row {
                TextButton(onClick = onUseCache) {
                    Text("ä½¿ç”¨ç¼“å­˜")
                }
                TextButton(onClick = onCancel) {
                    Text("å–æ¶ˆ")
                }
            }
        }
    )
}
```

---

## 6. æ€§èƒ½ä¼˜åŒ–UIæ¨¡å¼

### 6.1 é¢„åŠ è½½æç¤º
```kotlin
@Composable
fun PreloadingIndicator(
    preloadingState: PreloadingState
) {
    AnimatedVisibility(
        visible = preloadingState.isPreloading
    ) {
        Card(
            modifier = Modifier.padding(8.dp),
            colors = CardDefaults.cardColors(
                containerColor = MaterialTheme.colorScheme.secondaryContainer
            )
        ) {
            Row(
                modifier = Modifier.padding(12.dp),
                verticalAlignment = Alignment.CenterVertically
            ) {
                CircularProgressIndicator(
                    modifier = Modifier.size(16.dp),
                    strokeWidth = 2.dp
                )
                
                Spacer(modifier = Modifier.width(8.dp))
                
                Text(
                    text = "æ­£åœ¨å‡†å¤‡${preloadingState.contentType}...",
                    style = MaterialTheme.typography.bodySmall
                )
            }
        }
    }
}
```

### 6.2 æ™ºèƒ½åˆ·æ–°
```kotlin
@Composable
fun SmartRefreshLayout(
    refreshState: RefreshState,
    onRefresh: () -> Unit,
    content: @Composable () -> Unit
) {
    val pullRefreshState = rememberPullRefreshState(
        refreshing = refreshState.isRefreshing,
        onRefresh = onRefresh
    )
    
    Box(
        modifier = Modifier.pullRefresh(pullRefreshState)
    ) {
        content()
        
        PullRefreshIndicator(
            refreshing = refreshState.isRefreshing,
            state = pullRefreshState,
            modifier = Modifier.align(Alignment.TopCenter),
            contentColor = MaterialTheme.colorScheme.primary
        )
        
        // åå°æ›´æ–°æç¤º
        if (refreshState.isBackgroundRefresh) {
            Snackbar(
                modifier = Modifier.align(Alignment.BottomCenter),
                action = {
                    TextButton(onClick = refreshState.onCancelBackgroundRefresh) {
                        Text("å–æ¶ˆ")
                    }
                }
            ) {
                Text("æ­£åœ¨åå°æ›´æ–°å†…å®¹")
            }
        }
    }
}
```

---

## 7. å“åº”å¼å¸ƒå±€ä¼˜åŒ–

### 7.1 è‡ªé€‚åº”ç½‘æ ¼
```kotlin
@Composable
fun AdaptiveContentGrid(
    items: List<ContentItem>,
    isLoading: Boolean,
    hasMore: Boolean,
    onLoadMore: () -> Unit
) {
    val configuration = LocalConfiguration.current
    val columns = when {
        configuration.screenWidthDp < 600 -> 2
        configuration.screenWidthDp < 840 -> 3
        else -> 4
    }
    
    LazyVerticalGrid(
        columns = GridCells.Fixed(columns),
        contentPadding = PaddingValues(16.dp),
        horizontalArrangement = Arrangement.spacedBy(12.dp),
        verticalArrangement = Arrangement.spacedBy(12.dp)
    ) {
        items(items) { item ->
            ContentCard(item = item)
        }
        
        // åŠ è½½æ›´å¤š
        if (hasMore) {
            item(span = { GridItemSpan(columns) }) {
                LoadMoreIndicator(
                    isLoading = isLoading,
                    onLoadMore = onLoadMore
                )
            }
        }
    }
}
```

### 7.2 å¹³æ¿ä¼˜åŒ–å¸ƒå±€
```kotlin
@Composable
fun TabletOptimizedLayout(
    mainContent: @Composable () -> Unit,
    sidePanel: @Composable () -> Unit
) {
    val windowSizeClass = calculateWindowSizeClass()
    
    when (windowSizeClass.widthSizeClass) {
        WindowWidthSizeClass.Expanded -> {
            // å¹³æ¿æ¨ªå± - åˆ†æ å¸ƒå±€
            Row(modifier = Modifier.fillMaxSize()) {
                Box(
                    modifier = Modifier
                        .weight(2f)
                        .fillMaxHeight()
                ) {
                    mainContent()
                }
                
                VerticalDivider()
                
                Box(
                    modifier = Modifier
                        .weight(1f)
                        .fillMaxHeight()
                ) {
                    sidePanel()
                }
            }
        }
        else -> {
            // æ‰‹æœºæˆ–å¹³æ¿ç«–å± - å•åˆ—å¸ƒå±€
            mainContent()
        }
    }
}
```

---

## 8. è®¾è®¡ç³»ç»Ÿæ›´æ–°

### 8.1 åŠ è½½çŠ¶æ€è§„èŒƒ
```kotlin
object LoadingDesignSystem {
    // åŠ è½½æ—¶é•¿åˆ†çº§
    enum class LoadingDuration {
        INSTANT,     // <100ms - æ— éœ€æ˜¾ç¤º
        FAST,        // 100ms-1s - ç®€å•æŒ‡ç¤ºå™¨
        NORMAL,      // 1-3s - åŠ¨ç”»+æ–‡å­—
        SLOW         // >3s - è¿›åº¦+å–æ¶ˆé€‰é¡¹
    }
    
    // ç»Ÿä¸€çš„åŠ è½½ç»„ä»¶
    @Composable
    fun LoadingIndicator(
        duration: LoadingDuration,
        message: String? = null,
        onCancel: (() -> Unit)? = null
    ) {
        when (duration) {
            LoadingDuration.INSTANT -> { /* ä¸æ˜¾ç¤º */ }
            LoadingDuration.FAST -> MiniLoadingSpinner()
            LoadingDuration.NORMAL -> LoadingWithMessage(message)
            LoadingDuration.SLOW -> LoadingWithProgress(message, onCancel)
        }
    }
}
```

### 8.2 é”™è¯¯å¤„ç†è§„èŒƒ
```kotlin
object ErrorDesignSystem {
    // é”™è¯¯çº§åˆ«
    enum class ErrorSeverity {
        INFO,      // æç¤ºä¿¡æ¯
        WARNING,   // è­¦å‘Šï¼Œå¯ç»§ç»­
        ERROR,     // é”™è¯¯ï¼Œéœ€å¤„ç†
        CRITICAL   // ä¸¥é‡é”™è¯¯
    }
    
    // é”™è¯¯æ˜¾ç¤ºæ–¹å¼
    @Composable
    fun ErrorDisplay(
        severity: ErrorSeverity,
        message: String,
        action: ErrorAction?
    ) {
        when (severity) {
            ErrorSeverity.INFO -> InfoSnackbar(message)
            ErrorSeverity.WARNING -> WarningBanner(message, action)
            ErrorSeverity.ERROR -> ErrorDialog(message, action)
            ErrorSeverity.CRITICAL -> FullScreenError(message, action)
        }
    }
}
```

è¿™ä¸ªä¼˜åŒ–åçš„UIè®¾è®¡æ–¹æ¡ˆå……åˆ†è€ƒè™‘äº†äº‘ç«¯æ¶æ„çš„ç‰¹ç‚¹ï¼Œé€šè¿‡æ¸è¿›å¼åŠ è½½ã€æ™ºèƒ½ç¼“å­˜å±•ç¤ºã€å‹å¥½çš„é”™è¯¯å¤„ç†ç­‰è®¾è®¡ï¼Œç¡®ä¿å³ä½¿åœ¨ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ä¸ºç”¨æˆ·æä¾›æµç•…çš„ä½“éªŒã€‚